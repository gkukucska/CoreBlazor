@page "/DbContext/{DbContext}/DbSet/{DbSet}/Edit/{EntityId}"
@using CoreBlazor.Components
@using CoreBlazor.Configuration
@using Microsoft.AspNetCore.Components.Authorization
@inject IEnumerable<DiscoveredContext> DiscoveredContexts

<DynamicComponent Type="@ComponentType" Parameters="@Parameters" />

@code {
    [Parameter]
    public string DbContext { get; set; }
    [Parameter]
    public string DbSet { get; set; }
    [Parameter]
    public string EntityId { get; set; }
    public Type ComponentType { get; set; }
    public IDictionary<string, object> Parameters { get; set; } = new Dictionary<string, object>();

    protected override void OnParametersSet()
    {
        var discoveredContext = DiscoveredContexts.Single(x => x.ContextType.Name == DbContext);
        var discoveredSet = discoveredContext.Sets.Single(x => x.EntityType.Name == DbSet);
        ComponentType = typeof(EntityEditorComponent<,>).MakeGenericType(discoveredContext.ContextType, discoveredSet.EntityType);
        Parameters = new Dictionary<string, object>
        {
            { "EntityId", EntityId }
        };
    }

}