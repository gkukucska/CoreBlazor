@using System.Linq.Expressions
@using System.Reflection
@using CoreBlazor.Configuration
@using CoreBlazor.Interfaces
@using CoreBlazor.Utils
@using Microsoft.AspNetCore.Authorization
@using Microsoft.AspNetCore.Components.Authorization
@using Microsoft.AspNetCore.Http
@using Microsoft.EntityFrameworkCore
@using Microsoft.Extensions.DependencyInjection
@typeparam TContext where TContext : Microsoft.EntityFrameworkCore.DbContext
@typeparam TEntity where TEntity : class
@inject IDbContextFactory<TContext> ContextFactory;
@inject NavigationManager NavigationManager;
@inject CoreBlazorDbSetOptions<TContext,TEntity>? DbSetOptions;
<AuthorizeView Policy="@($"{typeof(TContext).Name}/{typeof(TEntity).Name}/{Identifiers.Create}")">
    <Authorized>
        <Button Color="ButtonColor.Primary" Type="ButtonType.Link" To="@($"/DbContext/{typeof(TContext).Name}/DbSet/{typeof(TEntity).Name}/Create")">
            Add New Entity
        </Button>
    </Authorized>
</AuthorizeView>
<AuthorizeView Policy="@($"{typeof(TContext).Name}/{typeof(TEntity).Name}/{Identifiers.EditOrDelete}")" Context="AuthorizeContext">
    <Authorized Context="AuthorizeContext">
        <DbSetGridComponent TContext="TContext" TEntity="TEntity" AllowRowClick="true"/>
    </Authorized>
    <NotAuthorized>
        <DbSetGridComponent TContext="TContext" TEntity="TEntity" AllowRowClick="false"  />
    </NotAuthorized>
</AuthorizeView>
